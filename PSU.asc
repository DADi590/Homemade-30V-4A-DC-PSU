Version 4
SHEET 1 14432 10312
WIRE 1936 -16 1824 -16
WIRE 2272 -16 1936 -16
WIRE 2384 -16 2272 -16
WIRE 2272 0 2272 -16
WIRE 1936 16 1936 -16
WIRE 3888 64 3840 64
WIRE 4000 64 3952 64
WIRE 4352 64 4240 64
WIRE 4416 64 4352 64
WIRE 4576 64 4496 64
WIRE 4640 64 4576 64
WIRE 4880 64 4800 64
WIRE 4912 64 4880 64
WIRE 5056 64 4992 64
WIRE 5184 64 5056 64
WIRE 4352 96 4352 64
WIRE 1936 112 1936 80
WIRE 2272 112 2272 80
WIRE 2384 112 2272 112
WIRE 2272 128 2272 112
WIRE 1936 176 1888 176
WIRE 2048 176 1936 176
WIRE 2128 176 2048 176
WIRE 3840 176 3840 64
WIRE 3888 176 3840 176
WIRE 4000 176 4000 64
WIRE 4000 176 3968 176
WIRE 4880 176 4880 64
WIRE 1936 208 1936 176
WIRE 2048 208 2048 176
WIRE 4352 208 4352 176
WIRE 4496 208 4352 208
WIRE 2272 224 2272 192
WIRE 4352 224 4352 208
WIRE 3904 240 3904 224
WIRE 3952 240 3952 224
WIRE 4832 240 4800 240
WIRE 5056 240 5056 64
WIRE 5056 240 4928 240
WIRE 4576 272 4576 64
WIRE 4576 272 4544 272
WIRE 1936 304 1936 272
WIRE 2048 304 2048 272
WIRE 4352 336 4352 304
WIRE 4448 336 4448 272
WIRE 1824 368 1824 -16
WIRE 1888 368 1888 176
WIRE 880 464 848 464
WIRE 976 464 944 464
WIRE 1472 464 1408 464
WIRE 1584 464 1552 464
WIRE 1712 464 1664 464
WIRE 2032 464 2000 464
WIRE 880 512 880 464
WIRE 944 512 944 464
WIRE 944 512 928 512
WIRE 1408 512 1408 464
WIRE 1888 512 1888 432
WIRE 1904 512 1888 512
WIRE 2000 512 2000 464
WIRE 2000 512 1984 512
WIRE 2032 512 2032 464
WIRE 2208 512 2032 512
WIRE 2272 512 2208 512
WIRE 2432 512 2352 512
WIRE 2528 512 2432 512
WIRE 2672 512 2592 512
WIRE 2736 512 2672 512
WIRE 2960 512 2736 512
WIRE 3296 512 2960 512
WIRE 3456 512 3296 512
WIRE 3520 512 3456 512
WIRE 3584 512 3520 512
WIRE 3520 528 3520 512
WIRE 1888 544 1888 512
WIRE 992 560 944 560
WIRE 2032 560 2000 560
WIRE 2960 560 2960 512
WIRE 2432 576 2432 512
WIRE 2672 576 2672 512
WIRE 1712 608 1712 464
WIRE 2736 608 2736 512
WIRE 5024 608 4848 608
WIRE 1296 624 1296 464
WIRE 1408 624 1408 592
WIRE 1408 624 1296 624
WIRE 3520 624 3520 608
WIRE 3456 640 3456 512
WIRE 4624 640 4224 640
WIRE 4848 640 4848 608
WIRE 4848 640 4800 640
WIRE 992 656 992 560
WIRE 992 656 944 656
WIRE 1408 656 1408 624
WIRE 1824 656 1824 432
WIRE 1888 656 1888 624
WIRE 1888 656 1824 656
WIRE 2000 656 2000 640
WIRE 2000 656 1888 656
WIRE 3040 656 3024 656
WIRE 3136 656 3120 656
WIRE 3296 656 3296 512
WIRE 2960 672 2960 640
WIRE 2960 672 2928 672
WIRE 3024 672 3024 656
WIRE 3024 672 2960 672
WIRE 3136 672 3136 656
WIRE 3264 672 3136 672
WIRE 1888 688 1888 656
WIRE 2960 688 2960 672
WIRE 3360 688 3328 688
WIRE 3392 688 3360 688
WIRE 4624 688 4624 640
WIRE 4800 688 4800 640
WIRE 5024 688 5024 608
WIRE 5072 688 5024 688
WIRE 5200 688 5152 688
WIRE 5424 688 5200 688
WIRE 5488 688 5424 688
WIRE 5648 688 5568 688
WIRE 5728 688 5648 688
WIRE 5776 688 5728 688
WIRE 944 704 928 704
WIRE 2432 704 2432 640
WIRE 2512 704 2432 704
WIRE 2672 704 2672 640
WIRE 2672 704 2576 704
WIRE 3264 704 3232 704
WIRE 2032 720 2032 656
WIRE 2048 720 2032 720
WIRE 2128 720 2128 656
WIRE 2128 720 2112 720
WIRE 3120 720 3104 720
WIRE 3232 720 3232 704
WIRE 3232 720 3200 720
WIRE 4624 736 4624 688
WIRE 4800 736 4800 688
WIRE 5200 736 5200 688
WIRE 848 752 848 464
WIRE 880 752 880 704
WIRE 880 752 848 752
WIRE 944 752 944 704
WIRE 976 752 976 464
WIRE 976 752 944 752
WIRE 4672 752 4672 704
WIRE 5424 752 5424 688
WIRE 1760 768 1760 544
WIRE 1776 768 1776 544
WIRE 2432 768 2432 704
WIRE 2736 768 2736 672
WIRE 2736 768 2432 768
WIRE 2960 768 2960 752
WIRE 3360 768 3360 688
WIRE 5728 768 5728 688
WIRE 2032 784 2032 720
WIRE 3456 784 3456 736
WIRE 3472 784 3456 784
WIRE 3936 784 3920 784
WIRE 4128 784 4096 784
WIRE 4624 784 4624 736
WIRE 4800 784 4800 736
WIRE 2128 800 2128 720
WIRE 2144 800 2128 800
WIRE 2736 800 2736 768
WIRE 4672 800 4672 752
WIRE 1408 816 1408 736
WIRE 1552 816 1408 816
WIRE 1712 816 1712 688
WIRE 1712 816 1552 816
WIRE 3936 832 3936 784
WIRE 1552 848 1552 816
WIRE 2960 848 2960 832
WIRE 4672 848 4672 800
WIRE 5200 848 5200 816
WIRE 5648 848 5648 688
WIRE 1888 896 1888 768
WIRE 2672 896 2672 704
WIRE 2672 896 1888 896
WIRE 5424 896 5424 832
WIRE 5424 896 5376 896
WIRE 5376 912 5376 896
WIRE 2960 944 2960 912
WIRE 3120 944 2960 944
WIRE 3296 944 3296 720
WIRE 3296 944 3120 944
WIRE 3360 944 3360 848
WIRE 3360 944 3296 944
WIRE 1552 960 1552 928
WIRE 3888 960 3872 960
WIRE 3936 960 3936 912
WIRE 3936 960 3888 960
WIRE 4032 960 3936 960
WIRE 5200 960 5200 928
WIRE 5200 960 5040 960
WIRE 5424 960 5424 896
WIRE 3120 976 3120 944
WIRE 4128 976 4128 784
WIRE 4096 992 4064 992
WIRE 5200 992 5200 960
WIRE 3936 1008 3936 960
WIRE 4208 1008 4160 1008
WIRE 4672 1008 4672 848
WIRE 4672 1008 4288 1008
WIRE 4032 1024 4032 960
WIRE 4096 1024 4032 1024
WIRE 3888 1040 3888 960
WIRE 3904 1040 3888 1040
WIRE 4064 1072 4064 992
WIRE 5040 1072 5040 960
WIRE 5040 1072 4064 1072
WIRE 3936 1104 3936 1072
WIRE 4032 1104 3936 1104
WIRE 4128 1104 4128 1040
WIRE 4128 1104 4032 1104
WIRE 5200 1104 5200 1072
WIRE 5328 1104 5200 1104
WIRE 5424 1104 5424 1040
WIRE 5424 1104 5328 1104
WIRE 5648 1104 5648 928
WIRE 5648 1104 5424 1104
WIRE 4032 1136 4032 1104
WIRE 5328 1136 5328 1104
WIRE 5264 1392 5264 1360
WIRE 5264 1392 5056 1392
WIRE 5120 1456 5088 1456
WIRE 5216 1456 5184 1456
WIRE 5120 1504 5120 1456
WIRE 5184 1504 5184 1456
WIRE 5184 1504 5168 1504
WIRE 5056 1552 5056 1392
WIRE 5104 1552 5056 1552
WIRE 5232 1552 5184 1552
WIRE 5232 1600 5232 1552
WIRE 5344 1600 5344 1360
WIRE 5344 1600 5232 1600
WIRE 5376 1600 5344 1600
WIRE 5104 1648 5040 1648
WIRE 5232 1648 5232 1600
WIRE 5232 1648 5184 1648
WIRE 5040 1664 5040 1648
WIRE 5184 1696 5168 1696
WIRE 5088 1744 5088 1456
WIRE 5104 1744 5088 1744
WIRE 5120 1744 5120 1696
WIRE 5120 1744 5104 1744
WIRE 5184 1744 5184 1696
WIRE 5200 1744 5184 1744
WIRE 5216 1744 5216 1456
WIRE 5216 1744 5200 1744
WIRE 5104 1808 5104 1744
WIRE 5120 1808 5104 1808
WIRE 5200 1808 5200 1744
WIRE 5200 1808 5184 1808
WIRE 5104 1856 5104 1808
WIRE 5200 1856 5200 1808
WIRE 5264 1856 5264 1840
WIRE 5264 1856 5200 1856
WIRE 5344 1856 5344 1840
WIRE 5376 1856 5376 1840
WIRE 5376 1856 5344 1856
FLAG 4352 336 0
FLAG 5328 1136 0
FLAG 4816 736 V637
IOPIN 4816 736 Out
FLAG 5024 736 V638
IOPIN 5024 736 In
FLAG 4240 96 V637
IOPIN 4240 96 In
FLAG 4656 128 V638
IOPIN 4656 128 Out
FLAG 4848 944 V639
IOPIN 4848 944 Out
FLAG 4448 384 V639
IOPIN 4448 384 In
FLAG 3584 512 Vunreg
IOPIN 3584 512 Out
FLAG 1552 960 0
FLAG 2208 512 IN+
FLAG 5776 688 OUT
IOPIN 5776 688 Out
FLAG 3104 720 OUT
IOPIN 3104 720 In
FLAG 3120 976 0
FLAG 4032 1136 0
FLAG 3472 784 CmpOut
IOPIN 3472 784 Out
FLAG 2144 800 CmpOut
IOPIN 2144 800 In
FLAG 1888 896 IN-
FLAG 2736 800 0
FLAG 3520 624 0
FLAG 2032 784 0
FLAG 4800 64 0
FLAG 4800 240 0
FLAG 5184 64 0
FLAG 4240 64 0
FLAG 4640 64 0
FLAG 4448 336 0
FLAG 2928 672 +16V
FLAG 1936 304 0
FLAG 2128 176 +34V
IOPIN 2128 176 Out
FLAG 3920 784 +5V
IOPIN 3920 784 In
FLAG 3904 240 ShortDetec
IOPIN 3904 240 In
FLAG 5376 912 ShortDetec
IOPIN 5376 912 In
FLAG 3952 240 0
FLAG 4224 640 Vunreg
IOPIN 4224 640 In
FLAG 5728 784 0
FLAG 5040 1664 0
FLAG 5104 1856 0
FLAG 5376 1840 ShortDetec
IOPIN 5376 1840 In
FLAG 2384 -16 +17V
IOPIN 2384 -16 Out
FLAG 2272 224 0
FLAG 2384 112 +5V
IOPIN 2384 112 Out
FLAG 2048 304 0
FLAG 4096 784 +34V
IOPIN 4096 784 In
FLAG 3872 960 +1.24V
FLAG 1936 112 0
SYMBOL polcap 2720 608 R0
WINDOW 3 24 56 Left 2
SYMATTR Value 42.5m
SYMATTR InstName C1-M
SYMATTR Description Capacitor
SYMATTR Type cap
SYMATTR SpiceLine V=63 Irms=3.355 Rser=0.004 Lser=14.3824n
SYMBOL schottky 2528 528 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D1
SYMATTR Value RBR5L60A
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL npn 4624 704 R270
SYMATTR InstName Q1_B
SYMATTR Value TIP142
SYMATTR Prefix X
SYMBOL res 5184 976 R0
SYMATTR InstName R11
SYMATTR Value 860
SYMBOL res 4400 80 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R6_B
SYMATTR Value 0.90
SYMBOL res 4336 208 R0
SYMATTR InstName R8_B
SYMATTR Value 10k
SYMBOL res 4336 80 R0
SYMATTR InstName R7_B
SYMATTR Value 1k
SYMBOL npn 4448 208 M90
SYMATTR InstName Q2_B
SYMATTR Value 2N2222
SYMBOL res 5184 832 R0
SYMATTR InstName R_Pot
SYMATTR Value 20k
SYMBOL res 4896 80 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R5_B
SYMATTR Value 0.36
SYMBOL npn 4832 176 M90
SYMATTR InstName Q3_B
SYMATTR Value 2N2222
SYMBOL res 5632 832 R0
SYMATTR InstName R22
SYMATTR Value 300
SYMBOL schottky 2448 640 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D4
SYMATTR Value RBR5L60A
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL voltage 1408 496 R0
WINDOW 123 0 0 Left 0
WINDOW 39 24 124 Left 2
SYMATTR SpiceLine Rser=0.1
SYMATTR InstName V3
SYMATTR Value SINE(0 10 5000)
SYMBOL ind2 1728 704 R180
WINDOW 0 36 80 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName L1
SYMATTR Value 367.36
SYMATTR Type ind
SYMBOL ind2 1904 784 R180
WINDOW 0 36 80 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName L2
SYMATTR Value 1
SYMATTR Type ind
SYMBOL ind2 1904 640 R180
WINDOW 0 36 80 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName L3
SYMATTR Value 1
SYMATTR Type ind
SYMBOL res 1456 480 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R2
SYMATTR Value 0.001
SYMBOL sw 848 656 R270
WINDOW 0 -16 15 Right 2
WINDOW 3 -11 113 Right 2
SYMATTR InstName RelS2
SYMATTR Value SwNC
SYMBOL sw 3984 176 M270
SYMATTR InstName S3
SYMATTR Value SwNO
SYMBOL zener 2944 912 M180
WINDOW 0 44 36 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D5
SYMATTR Value 1N750
SYMBOL res 1536 832 R0
SYMATTR InstName R5
SYMATTR Value 10000000Meg
SYMBOL res 2944 544 R0
SYMATTR InstName R3-M
SYMATTR Value 2k
SYMBOL sw 848 560 M90
WINDOW 0 -85 16 Left 2
WINDOW 3 -81 112 Left 2
SYMATTR InstName RelS1
SYMATTR Value SwNO
SYMBOL OpAmp\\LM358_TI 3296 688 R0
SYMATTR InstName U2
SYMBOL OpAmp\\LM358_TI 4128 1008 R0
SYMATTR InstName U1
SYMATTR Value LM6171A/NS
SYMBOL schottky 2512 720 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D3
SYMATTR Value RBR5L60A
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL schottky 2688 640 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D2
SYMATTR Value RBR5L60A
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL res 3344 752 R0
SYMATTR InstName R4
SYMATTR Value 20k
SYMBOL diode 2048 736 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D7-M
SYMATTR Value 1N4148
SYMBOL res 3520 512 R0
SYMATTR InstName R7
SYMATTR Value 25
SYMBOL miscellaneous\\ntc_resistor 1680 448 R90
WINDOW 3 40 56 VTop 2
SYMATTR Value R0=8
SYMATTR SpiceLine2 B=700000
SYMATTR InstName NTCR1-M
SYMBOL res 2256 528 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R1
SYMATTR Value 0.001
SYMBOL schottky 1904 432 R180
WINDOW 0 -45 64 Left 2
WINDOW 3 -112 5 Left 2
SYMATTR InstName D8-M
SYMATTR Value RBR5L60A
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL res 3136 640 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6-M
SYMATTR Value 20k
SYMBOL res 5408 736 R0
SYMATTR InstName R8
SYMATTR Value 20k
SYMBOL res 5408 944 R0
SYMATTR InstName R9
SYMATTR Value 20k
SYMBOL res 3216 704 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R10-M
SYMATTR Value 20k
SYMBOL sw 5088 1648 R270
WINDOW 0 -16 15 Right 2
WINDOW 3 -11 113 Right 2
SYMATTR InstName RelS3
SYMATTR Value SwNC
SYMBOL sw 5088 1552 M90
WINDOW 0 -85 16 Left 2
WINDOW 3 -81 112 Left 2
SYMATTR InstName RelS4
SYMATTR Value SwNO
SYMBOL diode 5120 1824 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D10
SYMATTR Value 1N4148
SYMBOL res 5472 704 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName Rout
SYMATTR Value 0.001
SYMBOL zener 2944 832 M180
WINDOW 0 42 35 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D6
SYMATTR Value 1N750
SYMBOL zener 2944 752 M180
WINDOW 0 42 35 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D12
SYMATTR Value MMBZ6V8ALY
SYMBOL zener 2256 192 M180
WINDOW 0 42 35 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName 1N5338B
SYMATTR Value UMZ5_1N
SYMBOL schottky 1840 432 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D13
SYMATTR Value RBR5L60A
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL res 2256 -16 R0
SYMATTR InstName R_Fan
SYMATTR Value 71
SYMBOL npn 3392 640 R0
SYMATTR InstName Q1
SYMATTR Value BC547B
SYMBOL voltage 1408 640 R0
WINDOW 123 24 124 Left 2
WINDOW 39 24 152 Left 2
SYMATTR Value2 AC 230 0
SYMATTR SpiceLine Rser=0.1
SYMATTR InstName V1
SYMATTR Value SINE(0 325.57 50)
SYMBOL REF\\tlv431 3920 1008 R0
SYMATTR InstName U4
SYMBOL res 3920 816 R0
SYMATTR InstName R19
SYMATTR Value 40k
SYMBOL res 4192 1024 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R2_B
SYMATTR Value 0.001
SYMBOL res 4816 624 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R12
SYMATTR Value 100m
SYMBOL res 4816 672 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R13
SYMATTR Value 100m
SYMBOL res 4816 720 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R14
SYMATTR Value 100m
SYMBOL res 4816 768 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R15
SYMATTR Value 100m
SYMBOL res 5056 704 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R18
SYMATTR Value 0.001
SYMBOL cap 1920 16 R0
SYMATTR InstName C7-M
SYMATTR Value 1m
SYMATTR SpiceLine V=35
SYMBOL res 2016 656 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R3
SYMATTR Value 0.001
SYMBOL res 1888 528 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R6
SYMATTR Value 0.001
SYMBOL res 5184 720 R0
SYMATTR InstName R10
SYMATTR Value 0
SYMBOL npn 4624 752 R270
SYMATTR InstName Q2
SYMATTR Value TIP142
SYMATTR Prefix X
SYMBOL npn 4624 800 R270
SYMATTR InstName Q3
SYMATTR Value TIP142
SYMATTR Prefix X
SYMBOL npn 4624 848 R270
SYMATTR InstName Q4
SYMATTR Value TIP142
SYMATTR Prefix X
SYMBOL cap 1920 208 R0
SYMATTR InstName C1-M
SYMATTR Value 1m
SYMATTR SpiceLine V=35
SYMBOL cap 2032 208 R0
SYMATTR InstName C2-M
SYMATTR Value 1m
SYMATTR SpiceLine V=35
TEXT 2432 936 Left 2 !.tran 0.35
TEXT 1664 864 Left 2 !K1 L1 L2 L3 1
TEXT 1480 1008 Left 2 !; For the relays\n.MODEL SwNO SW(Ron=10m Roff=1000Meg Vt=12 Vh=.5 Lser=10n Vser=.6)\n.MODEL SwNC SW(Roff=10m Ron=1000Meg Vt=0 Vh=.5 Lser=10n Vser=.6)
TEXT 1448 1144 Left 2 !**************************************\n*      Model Generated by MODPEX     *\n*Copyright(c) Symmetry Design Systems*\n*         All Rights Reserved        *\n*    UNPUBLISHED LICENSED SOFTWARE   *\n*   Contains Proprietary Information *\n*      Which is The Property of      *\n*     SYMMETRY OR ITS LICENSORS      *\n*    Modeling services provided by   *\n* Interface Technologies www.i-t.com *\n**************************************\n.SUBCKT TIP142 1 2 3\n* Model generated on Feb  8, 2004\n* Model format: PSpice\n* Darlington macro model\n* External node designations\n* Node 1 -> Collect\n* Node 2 -> Base\n* Node 3 -> Emitter\nQ1 1 2 4 qmodel\nQ2 1 4 3 q1model 19.6725\nD1 3 1 dmodel\nR1 2 4 8000\nR2 4 3 40\n* Default values used in dmodel\n*   EG=1.11 TT=0 BV=infinite\n.MODEL dmodel d\n+IS=1e-12 RS=10 N=1 XTI=3\n+CJO=0 VJ=0.75 M=0.33 FC=0.5\n.MODEL qmodel npn\n+IS=2.92836e-16 BF=233.76 NF=1.2 VAF=1000\n+IKF=0.222129 ISE=4.61322e-11 NE=2.48158 BR=1.89854\n+NR=0.75 VAR=168.458 IKR=0.108495 ISC=9.99999e-14\n+NC=2.00001 RB=7.90758 IRB=0.2 RBM=7.90758\n+RE=0.275456 RC=1.42279 XTB=0.232595 XTI=3.02293 EG=1.206\n+CJE=1e-11 VJE=0.75 MJE=0.33 TF=1e-09\n+XTF=1 VTF=10 ITF=0.01 CJC=1.67157e-09\n+VJC=0.95 MJC=0.23 XCJC=0.9 FC=0.5\n+TR=1e-07 PTF=0 KF=0 AF=1\n.MODEL q1model npn\n+IS=2.92836e-16 BF=233.76 NF=1.2 VAF=1000\n+IKF=0.222129 ISE=4.61322e-11 NE=2.48158 BR=1.89854\n+NR=0.75 VAR=168.458 IKR=0.108495 ISC=9.99999e-14\n+NC=2.00001 RB=7.90758 IRB=0.2 RBM=7.90758\n+RE=0.275456 RC=1.42279 XTB=0.232595 XTI=3.02293 EG=1.206\n+CJE=1e-11 VJE=0.75 MJE=0.33 TF=1e-09\n+XTF=1 VTF=10 ITF=0.01 CJC=0\n+VJC=0.95 MJC=0.23 XCJC=0.9 FC=0.5\n+TR=1e-07 PTF=0 KF=0 AF=1\n.ENDS
TEXT 4920 336 Left 2 ;Notice that put the protections makes the TIP current be stolen and VCE != 0\nalways (which means, less output voltage, even without an overload).\nPS: happens with any of the 2 protections.
TEXT 3168 976 Left 0 ;Above, a pull-down resistor so that the signal is not floating at t=0
TEXT 3624 1296 Left 2 ;ATTENTION: as said on Discord, there can be drifts in the reference voltage depending\non the ripple from the unregulated supply. Check if with the ripple being at most 3 V it's too\nbad or if we really must use an IC as a fixed DC PSU for the comparator.\nNote: say on the DOCX that you changed your mind because of this.
TEXT 2048 648 Left 2 ;Relay
TEXT 1584 416 Left 2 ;NTCR1-M
TEXT 2136 704 Left 0 ;Diode here to protect from the coil's back "infinite" EMF
TEXT 840 640 Left 2 ;NC
TEXT 840 576 Left 2 ;NO
TEXT 5128 1416 Left 2 ;Relay
TEXT 5080 1632 Left 2 ;NC
TEXT 5080 1568 Left 2 ;NO
TEXT 5040 1288 Left 0 ;Mechanical switch to toggle short-circuit protection\nSo no need for Foldback protection anymore - protection for overcurrent only
TEXT 4384 968 Left 0 ;Try to put a switch here too, and glue to the upper one so that both are controlled at the\nsame time. This way, the relay is bypassed and also disabled (why wear it out if it's not being\nused anyway?).
TEXT 5168 1232 Left 2 ;Put this in the unregulated part - cut the maximum power possible
TEXT 2840 464 Left 4 ;SCHMITT TRIGGER NEEDED HERE!!!!!!!!!!!
TEXT 3800 696 Left 1 ;This is just on paper. In practice, the 17 V rail must be given, as it's more stable than\nthe 5 V one (depends on the fan) - also because in practice, the LMV431 will be\nused, which can withstand up to 35 V (recommended 30 V).\nEDIT: unless the 5 V rail is more stable than the 17 V one (check with the scope, not here).
TEXT 4528 512 Left 1 ;Find another transistor with lower VBE (this one is 1.7 V...), and keep the gain high\n(no darlington pair needed then, which would get another VBE into account).\nEDIT: found one with 0.8 V @ 4 A: MJ15024
TEXT 5688 968 Left 2 ;7.5 Ohm minimum at 30 V (4 A)\nExcept voltage gets lowered. Test manually at 4 A.
TEXT 2272 1152 Left 2 !.MODEL TIP41C npn\n+IS=7.55826e-11 BF=260.542 NF=1.11221 VAF=100\n+IKF=0.526814 ISE=1e-08 NE=2.18072 BR=26.0542\n+NR=1.5 VAR=1000 IKR=3.54059 ISC=1e-08\n+NC=1.63849 RB=4.56157 IRB=0.1 RBM=0.1\n+RE=0.0162111 RC=0.0810556 XTB=0.1 XTI=1\n+EG=1.206 CJE=1.93296e-10 VJE=0.4 MJE=0.259503\n+TF=1e-08 XTF=4.06972 VTF=7.1157 ITF=0.001\n+CJC=1.09657e-10 VJC=0.730921 MJC=0.23 XCJC=0.803085\n+FC=0.8 CJS=0 VJS=0.75 MJS=0.5\n+TR=9.01013e-08 PTF=0 KF=0 AF=1\n* Model generated on Dec 27, 2003\n* Model format: PSpice
TEXT 2288 80 Left 0 ;17 - 5 = 12 V --> Fan voltage (hence R_fan)
TEXT 2072 -192 Left 6 ;Unregulated module
TEXT 2024 136 Left 2 ;Relay
TEXT 896 424 Left 2 ;Relay
TEXT 336 1152 Left 2 !*//////////////////////////////////////////////////////////////////////\n* (C) National Semiconductor, Inc.\n* Models developed and under copyright by:\n* National Semiconductor, Inc.  \n*/////////////////////////////////////////////////////////////////////\n* Legal Notice: This material is intended for free software support.\n* The file may be copied, and distributed; however, reselling the \n*  material is illegal\n*////////////////////////////////////////////////////////////////////\n* For ordering or technical information on these models, contact:\n* National Semiconductor's Customer Response Center\n*                 7:00 A.M.--7:00 P.M.  U.S. Central Time\n*                                (800) 272-9959\n* For Applications support, contact the Internet address:\n*  Appshelp@galaxy.nsc.com\n*/////////////////////////////////////////\n*LM6171A Operational Amplifier Macro-Model\n*/////////////////////////////////////////\n*\n*Connections       non-inverting input\n*                  | inverting input\n*                  | |  positive power supply\n*                  | | |  negative power supply\n*                  | | | |  output\n*                  | | | | |\n.SUBCKT LM6171A/NS 3 2 4 5 6\n* CAUTION:  SET .OPTIONS GMIN=1E-16 TO CORRECTLY MODEL INPUT BIAS CURRENT.\n* Features:\n* +/-15V Operation\n* Unity Gain Stable\n* Offset voltage (max) =             3mV\n* Gain-bandwidth product =           100 MHz \n* Supply current =                   2.5mA\n* Slew rate =                        3600V/uS\n* Open Loop gain =                   90dB\n********************************************************************\nEOX 120 10 31 32 2.0\nRCX 120 121 1K\nRDX 121 10 1K\nRBX 120 122 1K\nGOS 10 57 122 121 1.0\nRVOS 31 32 1K\nRINB 2 18 1000\nRINA 3 19 1000\nDIN1 5 18 DMOD2\nDIN2 18 4 DMOD2\nDIN3 5 19 DMOD2\nDIN4 19 4 DMOD2\nEXX 10 5 17 5 1.0\nEEE 10 50 17 5 1.0\nECC 40 10 4 17 1.0\nRAA 4 17 100MEG\nRBB 17 5 100MEG\nISET 10 24 1e-3\nDA1 24 23 DMOD1\nRBAL 23 22 1000\nESUPP 22 21 4 5 1.0\nVOFF 21 10 -1.25\nDA2 24 25 DMOD1\nVSENS1 25 26 DC 0\nRSET 26 10 1K\nCSET 26 10 1e-10\nFSET 10 31 VSENS1 1.0\nR001 34 10 1K\nFTEMP 10 27 VSENS1 1.0\nDTA 27 10 DMOD2\nDTB 28 29 DMOD2\nVTEMP 29 10 DC 0\nECMR 38 10 11 10 1.0\nVCMX 38 39 DC 0\nRCM2 41 10 1MEG\nEPSR 42 10 4 10 1.0\nCDC1 43 42 10U\nVPSX 43 44 DC 0\nRPSR2 45 10 1MEG\nFCXX 57 10 VCXX 100\nDCX1 98 97 DMOD1\nDCX2 95 94 DMOD1\nRCX1 99 98 100\nRCX2 94 99 100\nVCXX 99 96 DC 0\nECMX 96 10 11 10 1.0\nDLIM1 52 57 DMOD1\nDLIM2 57 51 DMOD1\nELIMP 51 10 26 10 99.3\nGDM 10 57 3 2 1\nC1 58 59 1e-10\nDCLMP2 59 40 DMOD1\nDCLMP1 50 59 DMOD1\nRO2 59 10 1K\nGO3 10 71 59 10 1\nRO3 71 10 1\nDDN1 73 74 DMOD1\nDDN2 73 710 DMOD1\nDDP1 75 72 DMOD1\nDDP2 71 720 DMOD1\nRDN2 710 71 100\nRDP 720 72 100\nVOOP 40 76 DC 0\nVOON 77 50 DC 0\nQNO 76 73 78 NPN1\nQNP 77 72 79 PNP1\nRNO 78 81 1\nRPO 79 81 1\nVOX 86 6 DC 0\nRNT 76 81 100MEG\nRPT 81 77 1MEG\nFX 10 93 VOX 1.0\nDFX1 93 91 DMOD1\nVFX1 91 10 DC 0\nDFX2 92 93 DMOD1\nVFX2 10 92 DC 0\nFPX 4 10 VFX1 1.0\nFNX 10 5 VFX2 1.0\nRAX 122 10 MRAX 1.006000e+03\n.MODEL MRAX RES (TC1=-1.1e-05)\nFIN1 18 5 VTEMP 0.985\nFIN2 19 5 VTEMP 1.015\nCIN1 2 10 1e-12\nCIN2 3 10 1e-12\nRD1 18 11 2.45e+06\nRD2 19 11 2.45e+06\nRCM 11 10 3.8775e+07\nFCMR 10 57 VCMX 3.16228\nFPSR 10 57 VPSX 63.2456\nRSLOPE 4 5 33333.3\nGPWR 4 5 26 10 0.0016\nETEMP 27 28 32 33 0.178427\nRIB 32 33 MRIB 1K\n.MODEL MRIB RES (TC1=0.00389579)\nRISC 33 34 MRISC 1K\n.MODEL MRISC RES (TC1=-0.002)\nRCM1 39 41 10\nCCM 41 10 2.65258e-11\nRPSR1 44 45 100\nCPSR 45 10 1.59155e-10\nELIMN 10 52 26 10 91.8926\nRDM 57 10 23.5073\nC2 57 10 4.78743e-11\nECMP 40 97 26 10 2\nECMN 95 50 26 10 2\nG2 58 10 57 10 0.00378\nR2 58 10 11.254\nGO2 59 10 58 10 35\nEPOS 40 74 26 10 1.4\nENEG 75 50 26 10 1.5\nGSOURCE 74 73 33 34 0.00135\nGSINK 72 75 33 34 0.00135\nROO 81 86 13\n.MODEL DMOD1 D\n*-- DMOD1 DEFAULT PARAMETERS\n*IS=1e-14 RS=0 N=1 TT=0 CJO=0\n*VJ=1 M=0.5 EG=1.11 XTI=3 FC=0.5\n*KF=0 AF=1 BV=inf IBV=1e-3 TNOM=27\n.MODEL DMOD2 D  (IS=1e-17)\n*-- DMOD2 DEFAULT PARAMETERS\n*RS=0 N=1 TT=0 CJO=0\n*VJ=1 M=0.5 EG=1.11 XTI=3 FC=0.5\n*KF=0 AF=1 BV=inf IBV=1e-3 TNOM=27\n.MODEL NPN1 NPN (BF=100 IS=1e-15)\n*-- NPN1 DEFAULT PARAMETERS\n*NF=1 VAF=inf IKF=inf ISE=0 NE=1.5\n*BR=1 NR=1 VAR=inf IKR=inf ISC=0\n*NC=2 RB=0 IRB=inf RBM=0 RE=0 RC=0\n*CJE=0 VJE=0.75 MJE=0.33 TF=0 XTF=0\n*VTF=inf ITF=0 PTF=0 CJC=0 VJC=0.75\n*MJC=0.33 XCJC=1 TR=0 CJS=0 VJS=0.75\n*MJS=0 XTB=0 EG=1.11 XTI=3 KF=0 AF=1\n*FC=0.5 TNOM=27\n.MODEL PNP1 PNP (BF=100 IS=1e-15)\n*-- PNP1 DEFAULT PARAMETERS\n*NF=1 VAF=inf IKF=inf ISE=0 NE=1.5\n*BR=1 NR=1 VAR=inf IKR=inf ISC=0\n*NC=2 RB=0 IRB=inf RBM=0 RE=0 RC=0\n*CJE=0 VJE=0.75 MJE=0.33 TF=0 XTF=0\n*VTF=inf ITF=0 PTF=0 CJC=0 VJC=0.75\n*MJC=0.33 XCJC=1 TR=0 CJS=0 VJS=0.75\n*MJS=0 XTB=0 EG=1.11 XTI=3 KF=0 AF=1\n*FC=0.5 TNOM=27\n.ENDS\n*$
TEXT 2272 1600 Left 2 !**************************************\n* Model Generated by MODPEX *\n*Copyright(c) Symmetry Design Systems*\n* All Rights Reserved *\n* UNPUBLISHED LICENSED SOFTWARE *\n* Contains Proprietary Information *\n* Which is The Property of *\n* SYMMETRY OR ITS LICENSORS *\n* Modeling services provided by *\n* Interface Technologies www.i-t.com *\n**************************************\n.SUBCKT tip147 1 2 3\n* Model generated on Feb 8, 2004\n* Model format: PSpice\n* Darlington macro model\n* External node designations\n* Node 1 -> Collect\n* Node 2 -> Base\n* Node 3 -> Emitter\nQ1 1 2 4 qmodel\nQ2 1 4 3 q1model 9.26065\nD1 1 3 dmodel\nR1 2 4 8000\nR2 4 3 40\n* Default values used in dmodel\n* EG=1.11 TT=0 BV=infinite\n.MODEL dmodel d\n+IS=1e-12 RS=10 N=1 XTI=3\n+CJO=0 VJ=0.75 M=0.33 FC=0.5\n.MODEL qmodel pnp\n+IS=1.03024e-14 BF=257.093 NF=1.2 VAF=679.126\n+IKF=0.190032 ISE=1.23159e-13 NE=1.73997 BR=1.10206\n+NR=1.19838 VAR=126.182 IKR=0.103332 ISC=1.23159e-13\n+NC=2 RB=5.06065 IRB=0.2 RBM=5.06065\n+RE=0.199903 RC=2.01466 XTB=0.354371 XTI=3.01199 EG=1.206\n+CJE=1e-11 VJE=0.75 MJE=0.33 TF=1e-09\n+XTF=1 VTF=10 ITF=0.01 CJC=1.67157e-09\n+VJC=0.95 MJC=0.23 XCJC=0.9 FC=0.5\n+TR=1e-07 PTF=0 KF=0 AF=1\n.MODEL q1model pnp\n+IS=1.03024e-14 BF=257.093 NF=1.2 VAF=679.126\n+IKF=0.190032 ISE=1.23159e-13 NE=1.73997 BR=1.10206\n+NR=1.19838 VAR=126.182 IKR=0.103332 ISC=1.23159e-13\n+NC=2 RB=5.06065 IRB=0.2 RBM=5.06065\n+RE=0.199903 RC=2.01466 XTB=0.354371 XTI=3.01199 EG=1.206\n+CJE=1e-11 VJE=0.75 MJE=0.33 TF=1e-09\n+XTF=1 VTF=10 ITF=0.01 CJC=0\n+VJC=0.95 MJC=0.23 XCJC=0.9 FC=0.5\n+TR=1e-07 PTF=0 KF=0 AF=1\n.ENDS
TEXT 4328 -184 Left 6 ;Regulator module
LINE Normal 832 448 1008 448 2
LINE Normal 832 768 832 448 2
LINE Normal 976 768 832 768 2
LINE Normal 1008 768 976 768 2
LINE Normal 1008 448 1008 768 2
LINE Normal 3952 32 3888 64 2
LINE Normal 5072 1440 5248 1440 2
LINE Normal 5072 1760 5072 1440 2
LINE Normal 5216 1760 5072 1760 2
LINE Normal 5248 1760 5216 1760 2
LINE Normal 5248 1440 5248 1760 2
LINE Normal 5344 1344 5264 1360 2
LINE Normal 5344 1824 5264 1840 2
LINE Normal 5296 1856 5296 1344 2
